# CVE-2023-36802 Local Privilege Escalation POC

authors: [chompie](https://twitter.com/chompie1337)

For demonstration purposes only. Complete exploit works on vulnerable Windows 11 22H2 systems. 
Adapting the exploit to all vulnerable systems is left as an exercise to the reader. Git gud, etc. 

Usage:

```
Windows_MSKSSRV_LPE_CVE-2023-6802.exe <pid>
```

where `<pid>` is the process ID (in decimal) of the process to elevate.

Should result in the target process being elevated to SYSTEM


The I/O Ring LPE primitive code is based on the I/ORing R/W [PoC](https://github.com/yardenshafir/IoRingReadWritePrimitive) by [Yarden Shafir](https://twitter.com/yarden_shafir)

Blog post [here](https://securityintelligence.com/posts/critically-close-to-zero-day-exploiting-microsoft-kernel-streaming-service/)

****Added by me BlockChainExpert2023****

DeepSeekCoder describes the algorithm used in the provided C code in a very simple manner, breaking it down into a few key steps:

1. **Pool Spraying**:
   - Allocate a large number of objects in the non-paged pool memory of the Windows kernel. This is done to control the memory layout and create predictable patterns.

2. **Create Holes**:
   - Free some of the allocated objects to create "holes" in the memory. This helps in manipulating the memory allocation behavior.

3. **Interact with Device Driver**:
   - Use specific IOCTL (Input/Output Control) commands to interact with a device driver (`MSKSSRV`). This interaction is likely where the vulnerability is exploited.

4. **Scan for Specific Pattern**:
   - After manipulating the memory, scan through the sprayed memory to find a specific pattern or condition that indicates a successful manipulation.

5. **Trigger Vulnerability**:
   - Once the specific pattern is found, trigger the vulnerability by sending further IOCTL commands to the device driver. This step aims to exploit the vulnerability and achieve the desired outcome, such as privilege escalation.

In essence, the algorithm involves:
- Spraying the kernel memory with controlled objects.
- Creating holes in the memory to manipulate allocation.
- Interacting with a device driver to exploit a vulnerability.
- Scanning for a specific pattern to confirm successful manipulation.
- Triggering the vulnerability to achieve the final goal.

This simplified description captures the core steps of the exploit while abstracting away the detailed implementation specifics.
